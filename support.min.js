!function(){"use strict";window.location.search&&-1!==window.location.search.indexOf("ignore_check")||window.Map||(window.location="error.html")}();

!function(){"use strict";if("function"!=typeof window.CustomEvent){var t=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n};t.prototype=window.Event.prototype,window.CustomEvent=t}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t}),Array.from||(Array.from=function(t){return Array.prototype.slice.call(t)})}();

!function(){"use strict";function e(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function t(e){return 9792===e||9794===e}function n(e){return 128104===e||128105===e}function r(e){return 128118===e||128102===e||128103===e}function i(e){return e>=65024&&e<=65039||e>=917760&&e<=917999}function o(e){return e>=127995&&e<=127999}function a(e){return e>=127462&&e<=127487}function u(e){return e<9757||t(e)||i(e)||o(e)||a(e)}function s(e){for(var t=e.length,n=[],r=0;r<t;){var i=e.charCodeAt(r++)||0;if(i<55296||i>56319||r===t);else{var o=e.charCodeAt(r)||0;if(56320==(64512&o)){++r,n.push(65536+(1023&o)+((1023&i)<<10));continue}}n.push(i)}return n}function d(e){if(!e.length)return[];for(var t=[{point:e[0],suffix:0}],n=[t],r=1;r<e.length;++r){var u=e[r];if(a(t[t.length-1].point));else{if(o(u)||i(u)){t[t.length-1].suffix=u;continue}if(8205===u){var s=e[++r];s&&t.push({point:s,suffix:0});continue}}t=[{point:u,suffix:0}],n.push(t)}return n}function c(i,a){var c={diversity:!1,gender:{single:!1,double:!1,neutral:!1}},l=d(s(i)),f=a?[]:null;if(l.some(function(e,i){var o=e[0].point,a=0,s=!1;e.forEach(function(e){var i=e.point;if(t(i))c.gender.single=!0,c.gender.neutral=!0;else if(n(i))c.gender.single=!0,++a>=2&&(c.gender.double=!0);else if(r(i)&&a)s=!0;else{var o=x(i);o&&(c.gender.single|=o.single,c.gender.neutral|=o.neutral)}});var d=a?n(o)&&1===a&&!s:void 0;if(d&&(c.diversity=b),f&&(f[i]=d),(c.diversity||!b)&&c.gender.neutral)return!f&&c.gender.single&&c.gender.double;if(!1!==d&&!u(o)){var l=String.fromCodePoint(o);b&&!c.diversity&&y(l+"\ud83c\udffb")&&(c.diversity=!0),!c.gender.neutral&&y(l+"\u200d\u2640\ufe0f")&&(c.gender.neutral=!0,c.gender.single=!0)}}),!a)return c;var v=function(){var e=a.gender||"",r=void 0,i=void 0;return function(o,a,u){void 0===r||o!==r?(r=o,i=0):++i;var s=e?e[i%e.length]:"",d=a||0;if(n(d))return s?"m"===s?128104:128105:d;if(!d||t(d))return s?"m"===s?9794:9792:0;if(u){var c=x(d);if(c){if(!s&&c.neutral)return c.points.n;if(s&&c.single)return"m"===s?c.points.m:c.points.f}}return--i,d}}(),p=l.map(function(e,n){var r=[],i=f[n],u=e[0].point;if(void 0!==a.gender){var s=void 0===i;if(e.forEach(function(e){return e.point=v(r,e.point,s)}),void 0===i&&1===e.length&&!t(u)){var d=v(r);d&&y(String.fromCodePoint(u)+"\u200d\u2640\ufe0f")&&e.push({suffix:65039,point:d})}}return void 0!==a.diversity&&e.forEach(function(e,t){o(e.suffix)?e.suffix=a.diversity:0===t&&b&&!1!==i&&(i||y(String.fromCodePoint(u)+"\ud83c\udffb"))&&(e.suffix=a.diversity)}),e.forEach(function(e){e.point&&(r.length&&r.push(8205),r.push(e.point),e.suffix&&r.push(e.suffix))}),r}).reduce(function(e,t){return e.concat(t)},[]);return c.out=String.fromCodePoint.apply(String,e(p)),c}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){window.requestAnimationFrame(function(n){q(e,t)})}function v(e,t){var n=new FormData;return n.append("name",e),n.append("emoji",t),window.fetch(S+"/name",{method:"POST",data:n,mode:"no-cors"})}function p(e){A=e}var m=Array.prototype.slice.call(buttons.querySelectorAll("button")),h=function(e){var t=(e?e.detail:typer.value).trim(),n=Boolean(t);document.body.classList.toggle("has-value",n),m.forEach(function(e){return e.disabled=!n})};typer.addEventListener("value",h),h(),function(e,t){var n=void 0,r=e.textContent,i=/\s*/,o=function(o){var a=[t.selectionStart,t.selectionEnd],u=a[0],s=a[1],d=0,c=t.value.length;if(t.selectionStart!==t.selectionEnd&&(d=t.selectionStart,c=t.selectionEnd),d+=i.exec(t.value.substr(d))[0].length,(c=d+t.value.substr(d,c-d).trim().length)<=d)return!1;t.focus(),t.selectionStart=d,t.selectionEnd=c;var l=!1;try{l=document.execCommand("copy")}catch(e){console.warn("could not copy",e),l=!1}var f=[u,s];if(t.selectionStart=f[0],t.selectionEnd=f[1],!l)return!0;console.info("copied",t.value.substr(d,c)),e.textContent=e.dataset.copied,window.clearTimeout(n),n=window.setTimeout(function(t){e.textContent=r},500)};t.addEventListener("keydown",function(n){"Enter"==n.key&&(e.click(),t.focus())}),e.addEventListener("click",function(t){o(),e.focus()})}(copy,typer);var g=function(){var e=document.createElement("canvas").getContext("2d");e.font="1px monospace";var t={},n=0;return function(r){var i=t[r];return void 0===i&&(t[r]=i=e.measureText(r).width,++n>4e3&&(t={},n=0)),i}}(),w=Boolean(/Mac|Android|iP(hone|od|ad)/),y=function(){if(w){var e=g("\ud83d\ude02");return function(t){return g(t)===e}}var t=context.measureText("\udbbf\udffd").width;return function(e){var n=g(e);return n!==t&&n<2*t}}(),E=function(){if(w){var t=g("\ud83d\ude02");return function(e){var n=d(s(e)),r=n.reduce(function(e,t){return e+=a(t[0].point)?1:0},0),i=n.length-Math.ceil(r/2),o=g(e)/t;return Math.floor(o)===o&&o<=i}}context.measureText("\udbbf\udffd").width;return function(t){for(var n=d(s(t)),r=0;r<n.length;++r){var i=n[r];if(a(i[0].point)){if(r===n.length-1||!a(i[r+1].point))return!1;var o=String.fromCodePoint.apply(String,e(i[r].point).concat([i[r+1].point]));if(!y(o))return!1;++r}else{var u=String.fromCodePoint.apply(String,e(i.map(function(e){return e.point})));if(!y(u))return!1}}return!0}}(),b=g("\ud83d\udc68\ud83c\udffb")===g("\ud83d\udc68"),x=function(){for(var e=[129334,127877,0,128131,128378,0,128112,129333,0,128103,128102,0,128117,128116,129491,128109,128108,0,128120,129332,0],t=new Map,n=0;n<e.length;n+=3)for(var r={points:{f:e[n],m:e[n+1],n:e[n+2]}},i=0;i<3;++i){var o=e[n+i];if(o){if(t.has(o))throw new Error("duplicate in gender list: "+o);t.set(o,r)}}return function(e){var n=t.get(e)||null;return n&&void 0===n.single&&(n.single=y(String.fromCodePoint(n.points.f))&&y(String.fromCodePoint(n.points.m)),n.neutral=n.points.n&&y(String.fromCodePoint(n.points.n))),n}}(),C=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(e){var t=function(e){return e<5e3&&32!=e},n=document.createElement("div");n.className="overflow-helper",e.parentNode.insertBefore(n,e);var r=document.createElement("div");r.className="underline",n.appendChild(r);var i=document.createElement("div");i.className="sizer",n.appendChild(i),"complete"!==document.readyState&&(r.classList.add("loading"),window.addEventListener("load",function(e){o(),r.classList.remove("loading")}));var o=function(t){if(void 0===e.dataset.from)return r.hidden=!0,!1;var n=+e.dataset.from,o=+e.dataset.to;i.textContent=e.value.substr(0,n);var a=n?i.getBoundingClientRect().width:15;i.textContent=e.value.substr(n,o-n);var u=i.getBoundingClientRect().width-15;u<0&&!document.getElementById("less")&&console.warn("invalid sizer width",u,"for text",i.textContent),r.hidden=u<=0,r.style.left=a+"px",r.style.width=u+"px",r.style.transform="translateX(-"+e.scrollLeft+"px)"},a=function(t,n){if(t>=n)return["from","to","prefix","word","focus"].forEach(function(t){return delete e.dataset[t]}),r.hidden=!0,!1;var i=[t,n];return e.dataset.from=i[0],e.dataset.to=i[1],e.dataset.focus=e.value.substr(t,n-t),o(),!0},u=e.value.length,s={start:u,end:u,value:void 0},d=function(n){if(!1!==n&&e.selectionStart===s.start&&e.selectionEnd===s.end&&e.value===s.value)return!0;var i=[e.selectionStart,e.selectionEnd];if(s.start=i[0],s.end=i[1],s.value!==e.value&&(e.dispatchEvent(new CustomEvent("value",{detail:e.value})),s.value=e.value),s.start!==s.end)return delete e.dataset.prefix,delete e.dataset.word,a(s.start,s.end),r.classList.add("range"),e.classList.add("range"),!1;r.classList.remove("range"),e.classList.remove("range");var o=s.start,u=s.start,d=!e.value.substr(s.end).trim()||!t(e.value.charCodeAt(s.end));if(d){for(;u>0&&32===e.value.charCodeAt(u-1);--u);u<o&&(o=u)}for(;o>0&&t(e.value.charCodeAt(o-1));--o);for(;u<e.value.length&&t(e.value.charCodeAt(u));++u);o>=u&&d&&n||a(o,u)&&(e.dataset.focus=e.dataset.prefix=e.value.substr(o,u-o),delete e.dataset.word)},f=function(t,n){if(t.has("focus")&&s.start===s.end){var r=[s.start,s.end];e.selectionStart=r[0],e.selectionEnd=r[1]}if(!d(n)){var i={text:e.dataset.prefix||e.dataset.word||null,prefix:"prefix"in e.dataset,focus:e.dataset.focus};e.dispatchEvent(new CustomEvent("query",{detail:i}))}},v=void 0;!function(){var t=void 0,n=new Set,r=function(e){t||(v=void 0,n.clear(),t=window.requestAnimationFrame(function(e){t=null,f(n,v)})),e&&n.add(e.type)};"change keydown keypress focus click mousedown select input".split(/\s+/).forEach(function(t){return e.addEventListener(t,r)}),r(),e.addEventListener("mousemove",function(e){e.which&&r()})}(),e.addEventListener("blur",function(t){if(e.selectionStart!==s.start||e.selectionStart!==s.end){var n=[s.start,s.end];e.selectionStart=n[0],e.selectionEnd=n[1]}}),e.addEventListener("keydown",function(t){switch(t.key){case"Escape":v=!1;break;case" ":e.dataset.prefix&&e.selectionStart===+e.dataset.to&&e.dispatchEvent(new CustomEvent("request",{detail:e.dataset.prefix}))}}),function(){var t=void 0,n=function(e){t||(t=window.requestAnimationFrame(function(e){t=null,o()}))};window.addEventListener("resize",n),e.addEventListener("wheel",n,{passive:!0})}();var p=function(t){var n;if(void 0===e.dataset.from||void 0===e.dataset.to)return!1;var r=+e.dataset.from,i=+e.dataset.to,o=e.value.substr(r,i-r),u=[typer.selectionStart,typer.selectionEnd],d=u[0],c=u[1],l=t(o);if(null==l)return!1;typer.value=typer.value.substr(0,r)+l+typer.value.substr(i);var f=function(e){return e>i?e=e-(i-r)+l.length:e>r&&(e=r+l.length),e};typer.focus(),typer.dispatchEvent(new CustomEvent("change"));var p=(n=[f(d),f(c)],typer.selectionStart=n[0],typer.selectionEnd=n[1],n),m=C(p,2);return s.start=m[0],s.end=m[1],v=!0,a(r,r+l.length),!0};e.addEventListener("modifier",function(e){var t=l({},e.detail.type,e.detail.code);p(function(e){return c(e,t).out||""})}),e.addEventListener("emoji",function(t){var n=t.detail.choice;p(function(e){return n})&&(e.dataset.word=t.detail.word||e.dataset.prefix,delete e.dataset.prefix)})}(typer);var S="https://emojityper.appspot.com",L=window.fetch(S+"/popular").then(function(e){return e.json()}).then(function(e){var t={};for(var n in e)for(var r=n.substr(0,3),i=1;i<=r.length;++i){var o=r.substr(0,i),a=t[o];a||(a=t[o]=[]),a.length<10&&a.push(n)}return function(n){var r=(n=n.toLowerCase()).substr(3),i=t[n.substr(0,3)]||[];return r&&(i=i.filter(function(e){return e.substr(3).startsWith(r)})),i=i.map(function(t){return{name:t,options:e[t]||[]}}),i.length?i:null}}),A=function(){},k=void 0,q=function(e,t){function n(e){k===r&&A(e)}if(window.clearTimeout(k),e){var r=window.setTimeout(function(r){var i=new FormData;i.append("q",e),i.append("prefix",t),window.fetch(S+"/query",{method:"POST",data:i}).then(function(e){return e.json()}).then(n)},2e3);k=r,L.then(function(r){var i=r(e);t||(i=i.filter(function(t){return t.name===e})),n(i)})}else A(null)};!function(e,t){var n=/[^\w:\.,$%^\-']+/g,r=function(e){return e?e.replace(n,"").toLowerCase():null},i=[];t.addEventListener("click",function(t){var n=t.target;if("button"!==n.localName);else if(n.dataset.modifier){var r="value"in n.dataset?+n.dataset.value||n.dataset.value:null,i={type:n.dataset.modifier,code:r};e.dispatchEvent(new CustomEvent("modifier",{detail:i}))}else{var o={choice:n.textContent,word:n.dataset.word};e.dispatchEvent(new CustomEvent("emoji",{detail:o}))}}),e.addEventListener("keydown",function(e){if("ArrowDown"===e.key){var n=t.querySelector("button");n&&n.focus()}}),t.addEventListener("keydown",function(t){switch(t.key){case"Escape":e.focus()}if(t.key.startsWith("Arrow")){var n=i.indexOf(document.activeElement);if(-1!==n){var r=void 0;if("ArrowLeft"===t.key?r=-1:"ArrowRight"===t.key&&(r=1),r){var o=n+r;o>=0&&o<i.length&&i[o].focus()}else{if("ArrowUp"===t.key)r=-1;else{if("ArrowDown"!==t.key)return;r=1}for(var a=document.activeElement.getBoundingClientRect(),u={dist:1/0,button:null},s=void 0,d=n;(d+=r)>=0&&d<i.length;){var c=i[d],l=c.getBoundingClientRect();if(a.top!==l.top){if(void 0===s&&(s=l.top),l.top!==s)break;var f=Math.abs(l.left-a.left);if(f<u.dist){var v=[f,c];u.dist=v[0],u.button=v[1]}}}u.button?u.button.focus():void 0===s&&r<0&&e.focus()}}}});var o=null,a=null;p(function(e){t.textContent="",i.length=0,o=e;var n=function(e,n){var r=document.createElement("div");r.className="options",n&&r.classList.add(n);var i=document.createElement("h4");i.textContent=e,r.appendChild(i);var o=document.createElement("div");return o.className="buttons",r.appendChild(o),t.appendChild(r),o},r=function(e,t){var n=document.createElement("button");return n.textContent=t,e.appendChild(n),i.push(n),n};if(a.focus&&!a.prefix){var u={},s=function(e,t,i){var o=u[e];o||(u[e]=o=n(e,"modifier"));var a=r(o,t);a.dataset.modifier=e,i&&(a.dataset.value=i)},d=c(a.focus);if(d.gender.neutral&&s("gender","\u2014"),d.gender.single&&s("gender","\u2640","f"),d.gender.double&&s("gender","\u2640\u2642","fm"),d.gender.single&&s("gender","\u2642","m"),d.gender.double&&s("gender","\u2642\u2640","mf"),d.diversity){s("diversity","\u2014");for(var l=127995;l<=127999;++l)s("diversity",String.fromCodePoint(l),l)}}(e||[]).forEach(function(e){var t=e.name,i=null;e.options.forEach(function(e){E(e)&&(i||(i=n(t)),r(i,e).dataset.word=t)})}),document.body.classList.toggle("has-chooser",i.length>0)}),e.addEventListener("query",function(e){f((a=e.detail).text,a.prefix)}),e.addEventListener("request",function(t){var n=r(t.detail),i=null;if((o||[]).some(function(e){return e.name===n&&(i=e.options[0],!0)}),i){var a={choice:i,word:n};e.dispatchEvent(new CustomEvent("emoji",{detail:a}))}})}(typer,chooser),function(e,t){var n=t.querySelector("form"),r=n.querySelector("input"),i=n.querySelector("button"),o="";e.addEventListener("query",function(e){var n=e.detail,i=null===n.text&&void 0!==n.focus;o=n.focus,t.hidden=!i,t.hidden&&(r.value="")});var a=function(e){i.disabled=!r.value};"input change".split(/\s+/).forEach(function(e){return r.addEventListener(e,a)}),n.addEventListener("submit",function(e){e.preventDefault(),n.classList.add("pending"),r.disabled=!0,i.disabled=!0;v(r.value,o).then(function(e){return i.classList.add("success"),!1}).catch(function(e){return i.classList.add("failure"),console.warn("failed to submit emoji",e),!0}).then(function(e){n.classList.remove("pending"),r.disabled=!1,r.value="",r.dispatchEvent(new CustomEvent("change"))}).then(function(e){return new Promise(function(e,t){return window.setTimeout(e,2e3)})}).then(function(e){i.className=""})})}(typer,advanced)}();

//# sourceMappingURL=support.min.js.map
