!function(){"use strict";window.location.search&&-1!==window.location.search.indexOf("ignore_check")||window.Map&&window.WeakMap||(window.location="error.html")}();

!function(){"use strict";function t(t,e){return e={exports:{}},t(e,e.exports),e.exports}var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=t(function(t){!function(e){function r(){}function o(t,e){return function(){t.apply(e,arguments)}}function i(t){if("object"!=n(this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function a(t,e){for(;3===t._state;)t=t._value;return 0===t._state?void t._deferreds.push(e):(t._handled=!0,void i._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void u(e.promise,t)}c(e.promise,r)}else(1===t._state?c:u)(e.promise,t._value)}))}function c(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==(void 0===e?"undefined":n(e))||"function"==typeof e)){var r=e.then;if(e instanceof i)return t._state=3,t._value=e,void f(t);if("function"==typeof r)return void l(o(r,e),t)}t._state=1,t._value=e,f(t)}catch(e){u(t,e)}}function u(t,e){t._state=2,t._value=e,f(t)}function f(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function s(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,c(e,t))},function(t){n||(n=!0,u(e,t))})}catch(t){if(n)return;n=!0,u(e,t)}}var h=setTimeout;i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(r);return a(this,new s(t,e,n)),n},i.all=function(t){var e=Array.prototype.slice.call(t);return new i(function(t,r){function o(a,c){try{if(c&&("object"==(void 0===c?"undefined":n(c))||"function"==typeof c)){var u=c.then;if("function"==typeof u)return void u.call(c,function(t){o(a,t)},r)}e[a]=c,0==--i&&t(e)}catch(t){r(t)}}if(0===e.length)return t([]);for(var i=e.length,a=0;a<e.length;a++)o(a,e[a])})},i.resolve=function(t){return t&&"object"==(void 0===t?"undefined":n(t))&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(t){return new i(function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)})},i._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){h(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},t.exports?t.exports=i:e.Promise||(e.Promise=i)}(e)});t(function(t){!function(e){function r(t,e,n,r){var o=e&&e.prototype instanceof i?e:i,a=Object.create(o.prototype),c=new p(r||[]);return a._invoke=s(t,n,c),a}function o(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function i(){}function a(){}function c(){}function u(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function f(t){function r(e,i,a,c){var u=o(t[e],t,i);if("throw"!==u.type){var f=u.arg,s=f.value;return s&&"object"===(void 0===s?"undefined":n(s))&&g.call(s,"__await")?Promise.resolve(s.__await).then(function(t){r("next",t,a,c)},function(t){r("throw",t,a,c)}):Promise.resolve(s).then(function(t){f.value=t,a(f)},c)}c(u.arg)}"object"===n(e.process)&&e.process.domain&&(r=e.process.domain.bind(r));var i;this._invoke=function(t,e){function n(){return new Promise(function(n,o){r(t,e,n,o)})}return i=i?i.then(n,n):n()}}function s(t,e,n){var r=j;return function(i,a){if(r===P)throw new Error("Generator is already running");if(r===S){if("throw"===i)throw a;return v()}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=l(c,n);if(u){if(u===O)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===j)throw r=S,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=P;var f=o(t,e,n);if("normal"===f.type){if(r=n.done?S:F,f.arg===O)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(r=S,n.method="throw",n.arg=f.arg)}}}function l(t,e){var n=t.iterator[e.method];if(n===m){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=m,l(t,e),"throw"===e.method))return O;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return O}var r=o(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,O;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=m),e.delegate=null,O):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,O)}function h(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function d(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function y(t){if(t){var e=t[b];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(g.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=m,e.done=!0,e};return r.next=r}}return{next:v}}function v(){return{value:m,done:!0}}var m,w=Object.prototype,g=w.hasOwnProperty,_="function"==typeof Symbol?Symbol:{},b=_.iterator||"@@iterator",x=_.asyncIterator||"@@asyncIterator",E=_.toStringTag||"@@toStringTag",L=e.regeneratorRuntime;if(L)t.exports=L;else{(L=e.regeneratorRuntime=t.exports).wrap=r;var j="suspendedStart",F="suspendedYield",P="executing",S="completed",O={},R={};R[b]=function(){return this};var T=Object.getPrototypeOf,k=T&&T(T(y([])));k&&k!==w&&g.call(k,b)&&(R=k);var G=c.prototype=i.prototype=Object.create(R);a.prototype=G.constructor=c,c.constructor=a,c[E]=a.displayName="GeneratorFunction",L.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===a||"GeneratorFunction"===(e.displayName||e.name))},L.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,E in t||(t[E]="GeneratorFunction")),t.prototype=Object.create(G),t},L.awrap=function(t){return{__await:t}},u(f.prototype),f.prototype[x]=function(){return this},L.AsyncIterator=f,L.async=function(t,e,n,o){var i=new f(r(t,e,n,o));return L.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},u(G),G[E]="Generator",G[b]=function(){return this},G.toString=function(){return"[object Generator]"},L.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},L.values=y,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(d),!t)for(var e in this)"t"===e.charAt(0)&&g.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=m)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){function e(e,r){return i.type="throw",i.arg=t,n.next=e,r&&(n.method="next",n.arg=m),!!r}if(this.done)throw t;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var a=g.call(o,"catchLoc"),c=g.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&g.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,O):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),O},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),d(n),O}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;d(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:y(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=m),O}}}}("object"===n(e)?e:"object"===("undefined"==typeof window?"undefined":n(window))?window:"object"===("undefined"==typeof self?"undefined":n(self))?self:e)});if("function"!=typeof window.CustomEvent){var o=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n};o.prototype=window.Event.prototype,window.CustomEvent=o}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t}),Array.from||(Array.from=function(t){return Array.prototype.slice.call(t)}),window.Promise||(window.Promise=r)}();

!function(){"use strict";function e(e){return 9792===e||9794===e}function t(e){return 128104===e||128105===e}function n(e){return 128118===e||128102===e||128103===e}function r(e){return e>=65024&&e<=65039||e>=917760&&e<=917999}function o(e){return e>=127995&&e<=127999}function i(e){return e>=127462&&e<=127487}function a(t){return t<9757||e(t)||r(t)||o(t)||i(t)}function u(e){for(var t=e.length,n=[],r=0;r<t;){var o=e.charCodeAt(r++)||0;if(o<55296||o>56319||r===t);else{var i=e.charCodeAt(r)||0;if(56320==(64512&i)){++r,n.push(65536+(1023&i)+((1023&o)<<10));continue}}n.push(o)}return n}function s(e){if(!e.length)return[];for(var t=[{point:e[0],suffix:0}],n=[t],a=1;a<e.length;++a){var u=e[a];if(i(t[t.length-1].point));else{if(o(u)||r(u)){t[t.length-1].suffix=u;continue}if(8205===u){var s=e[++a];s&&t.push({point:s,suffix:0});continue}}t=[{point:u,suffix:0}],n.push(t)}return n}function d(r,i){var d={diversity:!1,gender:{single:!1,double:!1,neutral:!1}},c=s(u(r)),l=i?[]:null;if(c.some(function(r,o){var i=r[0].point,u=0,s=!1;r.forEach(function(r){var o=r.point;if(e(o))d.gender.single=!0,d.gender.neutral=!0;else if(t(o))d.gender.single=!0,++u>=2&&(d.gender.double=!0);else if(n(o)&&u)s=!0;else{var i=k(o);i&&(d.gender.single|=i.single,d.gender.neutral|=i.neutral)}});var c=u?t(i)&&1===u&&!s:void 0;if(c&&(d.diversity=L),l&&(l[o]=c),(d.diversity||!L)&&d.gender.neutral)return!l&&d.gender.single&&d.gender.double;if(!1!==c&&!a(i)){var f=String.fromCodePoint(i);L&&!d.diversity&&C(f+"\ud83c\udffb")&&(d.diversity=!0),!d.gender.neutral&&C(f+"\u200d\u2640\ufe0f")&&(d.gender.neutral=!0,d.gender.single=!0)}}),!i)return d;var f=function(){var n=i.gender||"",r=void 0,o=void 0;return function(i,a,u){void 0===r||i!==r?(r=i,o=0):++o;var s=n?n[o%n.length]:"",d=a||0;if(t(d))return s?"m"===s?128104:128105:d;if(!d||e(d))return s?"m"===s?9794:9792:0;if(u){var c=k(d);if(c){if(!s&&c.neutral)return c.points.n;if(s&&c.single)return"m"===s?c.points.m:c.points.f}}return--o,d}}(),v=c.map(function(t,n){var r=[],a=l[n],u=t[0].point;if(void 0!==i.gender){var s=void 0===a;if(t.forEach(function(e){return e.point=f(r,e.point,s)}),void 0===a&&1===t.length&&!e(u)){var d=f(r);d&&C(String.fromCodePoint(u)+"\u200d\u2640\ufe0f")&&t.push({suffix:65039,point:d})}}return void 0!==i.diversity&&t.forEach(function(e,t){o(e.suffix)?e.suffix=i.diversity:0===t&&L&&!1!==a&&(a||C(String.fromCodePoint(u)+"\ud83c\udffb"))&&(e.suffix=i.diversity)}),t.forEach(function(e){e.point&&(r.length&&r.push(8205),r.push(e.point),e.suffix&&r.push(e.suffix))}),r}).reduce(function(e,t){return e.concat(t)},[]);return d.out=String.fromCodePoint.apply(String,E(v)),d}function c(e){for(var t=e.dataset,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];r.forEach(function(e){e in t&&delete t[e]})}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r={},o={};return e.forEach(function(e){var i=e[0];o[i]=e.slice(1);for(var a=i.substr(0,t),u=1;u<=a.length;++u){var s=a.substr(0,u),d=r[s];d||(d=r[s]=[]),d.length<n&&d.push(i)}}),function(e){var n=(e=e.toLowerCase()).substr(t),i=r[e.substr(0,t)]||[];return n&&(i=i.filter(function(e){return e.substr(t).startsWith(n)})),i=i.map(function(e){return{name:e,options:o[e]||[]}}),i.length?i:null}}function f(e,t){window.requestAnimationFrame(function(n){B(e,t)})}function v(e,t){M[e]=t,window.clearTimeout(O),O=window.setTimeout(function(e){var t=JSON.stringify(M);M={},window.fetch(A+"/select",{method:"POST",body:t})},5e3)}function p(e,t){var n=new FormData;return n.append("name",e),n.append("emoji",t),window.fetch(A+"/name",{method:"POST",mode:"cors",body:n})}function m(e){var t=F.get(e);if(t)return t;var n=document.createElement("button");return n.textContent=e,F.set(e,n),n}window.requestIdleCallback||(window.requestIdleCallback=function(e){var t=performance.now(),n=e.bind(null,{didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(performance.now()-t))}});return window.setTimeout(n,1)},window.cancelIdleCallback=function(e){return window.clearTimeout(e)});var h=Array.prototype.slice.call(buttons.querySelectorAll("button")),g=function(e){var t=(e?e.detail:typer.value).trim(),n=Boolean(t);document.body.classList.toggle("has-value",n),h.forEach(function(e){return e.disabled=!n})};typer.addEventListener("value",g),g(),function(e,t){var n=void 0,r=e.textContent,o=/\s*/,i=function(i){var a=[t.selectionStart,t.selectionEnd],u=a[0],s=a[1],d=0,c=t.value.length;if(t.selectionStart!==t.selectionEnd&&(d=t.selectionStart,c=t.selectionEnd),d+=o.exec(t.value.substr(d))[0].length,(c=d+t.value.substr(d,c-d).trim().length)<=d)return!1;t.focus(),t.selectionStart=d,t.selectionEnd=c;var l=!1;try{l=document.execCommand("copy")}catch(e){console.warn("could not copy",e),l=!1}var f=[u,s];if(t.selectionStart=f[0],t.selectionEnd=f[1],!l)return!0;console.info("copied",t.value.substr(d,c)),e.textContent=e.dataset.copied,window.clearTimeout(n),n=window.setTimeout(function(t){e.textContent=r},500)};t.addEventListener("keydown",function(n){"Enter"==n.key&&(e.click(),t.focus())}),e.addEventListener("click",function(t){i(),e.focus()})}(copy,typer);var w=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},y=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},b=function(){var e=document.createElement("canvas").getContext("2d");e.font="1px monospace";var t={},n=0;return function(r){var o=t[r];return void 0===o&&(t[r]=o=e.measureText(r).width,++n>4e3&&(t={},n=0)),o}}(),x=Boolean(/Mac|Android|iP(hone|od|ad)/),C=function(){if(x){var e=b("\ud83d\ude02");return function(t){return b(t)===e}}var t=context.measureText("\udbbf\udffd").width;return function(e){var n=b(e);return n!==t&&n<2*t}}(),S=function(){if(x){var e=b("\ud83d\ude02");return function(t){var n=s(u(t)),r=n.reduce(function(e,t){return e+=i(t[0].point)?1:0},0),o=n.length-Math.ceil(r/2),a=b(t)/e;return Math.floor(a)===a&&a<=o}}context.measureText("\udbbf\udffd").width;return function(e){for(var t=s(u(e)),n=0;n<t.length;++n){var r=t[n];if(i(r[0].point)){if(n===t.length-1||!i(r[n+1].point))return!1;var o=String.fromCodePoint.apply(String,E(r[n].point).concat([r[n+1].point]));if(!C(o))return!1;++n}else{var a=String.fromCodePoint.apply(String,E(r.map(function(e){return e.point})));if(!C(a))return!1}}return!0}}(),L=b("\ud83d\udc68\ud83c\udffb")===b("\ud83d\udc68"),k=function(){for(var e=[129334,127877,0,128131,128378,0,128112,129333,0,128103,128102,0,128117,128116,129491,128109,128108,0,128120,129332,0],t=new Map,n=0;n<e.length;n+=3)for(var r={points:{f:e[n],m:e[n+1],n:e[n+2]}},o=0;o<3;++o){var i=e[n+o];if(i){if(t.has(i))throw new Error("duplicate in gender list: "+i);t.set(i,r)}}return function(e){var n=t.get(e)||null;return n&&void 0===n.single&&(n.single=C(String.fromCodePoint(n.points.f))&&C(String.fromCodePoint(n.points.m)),n.neutral=n.points.n&&C(String.fromCodePoint(n.points.n))),n}}();!function(e){var t=function(e){return e<5e3&&32!=e},n=document.createElement("div");n.className="overflow-helper",e.parentNode.insertBefore(n,e);var r=document.createElement("div");r.className="underline",n.appendChild(r);var o=document.createElement("div");o.className="sizer",n.appendChild(o),"complete"!==document.readyState&&(r.classList.add("loading"),window.addEventListener("load",function(e){i(),r.classList.remove("loading")}));var i=function(t){if(void 0===e.dataset.from)return r.hidden=!0,!1;var n=+e.dataset.from,i=+e.dataset.to;o.textContent=e.value.substr(0,n);var a=n?o.getBoundingClientRect().width:15;o.textContent=e.value.substr(n,i-n);var u=o.getBoundingClientRect().width-15;u<0&&!document.getElementById("less")&&console.warn("invalid sizer width",u,"for text",o.textContent),r.hidden=u<=0,r.style.left=a+"px",r.style.width=u+"px",r.style.transform="translateX(-"+e.scrollLeft+"px)"},a=function(t,n){if(t>=n)return c(e,"from","to","prefix","word","focus"),r.hidden=!0,!1;var o=[t,n];return e.dataset.from=o[0],e.dataset.to=o[1],e.dataset.focus=e.value.substr(t,n-t),i(),!0},u=e.value.length,s={start:u,end:u,value:void 0},l=function(n){if(!1!==n&&e.selectionStart===s.start&&e.selectionEnd===s.end&&e.value===s.value)return!0;var o=[e.selectionStart,e.selectionEnd];if(s.start=o[0],s.end=o[1],s.value!==e.value&&(e.dispatchEvent(new CustomEvent("value",{detail:e.value})),s.value=e.value),s.start!==s.end)return c(e,"prefix","word"),a(s.start,s.end),r.classList.add("range"),e.classList.add("range"),!1;r.classList.remove("range"),e.classList.remove("range");var i=s.start,u=s.start,d=!e.value.substr(s.end).trim()||!t(e.value.charCodeAt(s.end));if(d){for(;u>0&&32===e.value.charCodeAt(u-1);--u);u<i&&(i=u)}for(;i>0&&t(e.value.charCodeAt(i-1));--i);for(;u<e.value.length&&t(e.value.charCodeAt(u));++u);i>=u&&d&&n||a(i,u)&&(e.dataset.focus=e.dataset.prefix=e.value.substr(i,u-i),c(e,"word"))},f=function(t,n){if(t.has("focus")&&s.start===s.end){var r=[s.start,s.end];e.selectionStart=r[0],e.selectionEnd=r[1]}if(!l(n)){var o={text:e.dataset.prefix||e.dataset.word||null,prefix:"prefix"in e.dataset,focus:e.dataset.focus};e.dispatchEvent(new CustomEvent("query",{detail:o}))}},v=void 0;!function(){var t=void 0,n=new Set,r=function(e){t||(v=void 0,n.clear(),t=window.requestAnimationFrame(function(e){t=null,f(n,v)})),e&&n.add(e.type)};"change keydown keypress focus click mousedown select input".split(/\s+/).forEach(function(t){return e.addEventListener(t,r)}),r(),e.addEventListener("mousemove",function(e){e.which&&r()})}(),e.addEventListener("blur",function(t){if(e.selectionStart!==s.start||e.selectionStart!==s.end){var n=[s.start,s.end];e.selectionStart=n[0],e.selectionEnd=n[1]}}),e.addEventListener("keydown",function(t){switch(t.key){case"Escape":v=!1;break;case" ":e.dataset.prefix&&e.selectionStart===+e.dataset.to&&e.dispatchEvent(new CustomEvent("request",{detail:e.dataset.prefix}))}}),function(){var t=void 0,n=function(e){t||(t=window.requestAnimationFrame(function(e){t=null,i()}))};window.addEventListener("resize",n),e.addEventListener("wheel",n,{passive:!0})}();var p=function(t){var n;if(void 0===e.dataset.from||void 0===e.dataset.to)return!1;var r=+e.dataset.from,o=+e.dataset.to,i=e.value.substr(r,o-r),u=[typer.selectionStart,typer.selectionEnd],d=u[0],c=u[1],l=t(i);if(null==l)return!1;typer.value=typer.value.substr(0,r)+l+typer.value.substr(o);var f=function(e){return e>o?e=e-(o-r)+l.length:e>r&&(e=r+l.length),e};typer.focus(),typer.dispatchEvent(new CustomEvent("change"));var p=(n=[f(d),f(c)],typer.selectionStart=n[0],typer.selectionEnd=n[1],n),m=y(p,2);return s.start=m[0],s.end=m[1],v=!0,a(r,r+l.length),!0};e.addEventListener("modifier",function(e){var t=w({},e.detail.type,e.detail.code);p(function(e){return d(e,t).out||""})}),e.addEventListener("emoji",function(t){var n=t.detail.choice;p(function(e){return n})&&(e.dataset.word=t.detail.word||e.dataset.prefix,c(e,"prefix"))})}(typer);var A="https://us-central1-emojityper.cloudfunctions.net",q=void 0;try{var N=JSON.parse(window.localStorage.popular);N.created>=+new Date-864e5&&(q=Promise.resolve(l(N.results)),console.debug("got indexed localStorage"))}catch(e){console.debug("couldn't parse localStorage popular",e)}if(!q){var P=window.fetch(A+"/popular").then(function(e){return e.json()});P.then(function(e){e.created=+new Date,window.localStorage.popular=JSON.stringify(e)});var T=P.then(function(e){return l(e.results)});q?T.then(function(){return q=T}):q=T}var j=function(){},R=void 0,B=function(e,t){function n(e){R===r&&j(e)}if(window.clearTimeout(R),e){var r=window.setTimeout(function(r){var o=A+"/query?query="+encodeURIComponent(e);t&&(o+="&prefix=true"),window.fetch(o).then(function(e){return e.json()}).then(function(e){n(e.results.map(function(e){return{name:e[0],options:e.slice(1)}}))})},2e3);R=r,q.then(function(r){var o=r(e);t||(o=o.filter(function(t){return t.name===e})),n(o)})}else j(null)},M={},O=void 0,D=/[^\w:\.,$%^\-']+/g,I=function(e){return e?e.replace(D,"").toLowerCase():null},F=new Map;chooser.addEventListener("click",function(e){var t=e.target;if("button"!==t.localName);else if(t.parentNode.dataset.modifier){var n="value"in t.dataset?+t.dataset.value||t.dataset.value:null,r={type:t.parentNode.dataset.modifier,code:n};typer.dispatchEvent(new CustomEvent("modifier",{detail:r}))}else{var o=t.parentNode.dataset.word,i={choice:t.textContent,word:o};typer.dispatchEvent(new CustomEvent("emoji",{detail:i})),v(o,i.choice)}}),typer.addEventListener("keydown",function(e){if("ArrowDown"===e.key){var t=chooser.querySelector("button");t&&t.focus()}}),chooser.addEventListener("keydown",function(e){switch(e.key){case"Escape":typer.focus()}if(e.key.startsWith("Arrow")&&document.activeElement&&chooser.contains(document.activeElement)){var t=Array.from(chooser.querySelectorAll("button")),n=t.indexOf(document.activeElement);if(-1!==n){var r=void 0;if("ArrowLeft"===e.key?r=-1:"ArrowRight"===e.key&&(r=1),r){var o=n+r;o>=0&&o<t.length&&t[o].focus()}else{if("ArrowUp"===e.key)r=-1;else{if("ArrowDown"!==e.key)return;r=1}for(var i=document.activeElement.getBoundingClientRect(),a={dist:1/0,button:null},u=void 0,s=n;(s+=r)>=0&&s<t.length;){var d=t[s],c=d.getBoundingClientRect();if(i.top!==c.top){if(void 0===u&&(u=c.top),c.top!==u)break;var l=Math.abs(c.left-i.left);if(l<a.dist){var f=[l,d];a.dist=f[0],a.button=f[1]}}}a.button?a.button.focus():void 0===u&&r<0&&typer.focus()}}}});var z=null,J=null;!function(e){j=e}(function(e){z=e,chooser.textContent="";var t=document.createElement("span");chooser.appendChild(t);var n=new Map;if(J.focus&&!J.prefix){var r=function(e){var t=document.createElement("div");t.className="options modifier";var n=document.createElement("div");n.className="buttons",n.dataset.modifier=e,t.appendChild(n);var r=document.createElement("h4");return r.textContent=e,t.appendChild(r),chooser.appendChild(t),n},o=function(e,t,n){var r=document.createElement("button");r.textContent=t,n&&(r.dataset.value=n),e.appendChild(r)},i=d(J.focus);if(i.gender.single||i.gender.double){var a=r("gender");i.gender.neutral&&o(a,"\u2014"),i.gender.single&&o(a,"\u2640","f"),i.gender.double&&o(a,"\u2640\u2642","fm"),i.gender.single&&o(a,"\u2642","m"),i.gender.double&&o(a,"\u2642\u2640","mf")}if(i.diversity){var u=r("diversity");o(u,"\u2014");for(var s=127995;s<=127999;++s)o(u,String.fromCodePoint(s),s)}}var c=document.createDocumentFragment(),l={};e&&e.forEach(function(e){var t=e.name,r=document.createElement("div");r.className="options";var o=document.createElement("div");o.className="buttons",o.dataset.word=t,r.appendChild(o);var i=document.createElement("h4");i.textContent=t,r.appendChild(i),c.appendChild(r),l[t]=o,e.pending=e.options.filter(function(e){var t=F.get(e);return!t||(n.has(e)||(o.appendChild(t),n.set(e,t)),!1)})}),F=n,chooser.appendChild(c),e&&function(){var n,r,o,i,a,u,s,d;return regeneratorRuntime.async(function(c){for(;;)switch(c.prev=c.next){case 0:n=null,r=0;case 2:if(!(o=e[r])){c.next=21;break}i=o.pending,a=0;case 5:if(!(u=i[a])){c.next=17;break}if(n&&!(n.timeRemaining()<=0)){c.next=13;break}return s=new Promise(function(e){return window.requestIdleCallback(function(t){return e(t)})}),c.next=10,regeneratorRuntime.awrap(s);case 10:if(n=c.sent,t.parentNode){c.next=13;break}return c.abrupt("return");case 13:!F.has(u)&&S(u)&&(d=l[o.name]).appendChild(m(u));case 14:++a,c.next=5;break;case 17:case 18:++r,c.next=2;break;case 21:case 22:case"end":return c.stop()}},null,this)}().catch(function(e){return console.warn("couldn't render emoji",e)})}),typer.addEventListener("query",function(e){f((J=e.detail).text,J.prefix)}),typer.addEventListener("request",function(e){var t=I(e.detail),n=null;if((z||[]).some(function(e){return e.name===t&&(n=e.options[0],!0)}),n){var r={choice:n,word:t};typer.dispatchEvent(new CustomEvent("emoji",{detail:r}))}}),function(e,t){var n=t.querySelector("form"),r=n.querySelector("input"),o=n.querySelector("button"),i="";e.addEventListener("query",function(e){var n=e.detail,o=null===n.text&&void 0!==n.focus;i=n.focus,t.hidden=!o,t.hidden&&(r.value="")});var a=function(e){o.disabled=!r.value};"input change".split(/\s+/).forEach(function(e){return r.addEventListener(e,a)}),n.addEventListener("submit",function(e){e.preventDefault(),n.classList.add("pending"),r.disabled=!0,o.disabled=!0;p(r.value,i).then(function(e){return o.classList.add("success"),!1}).catch(function(e){return o.classList.add("failure"),console.warn("failed to submit emoji",e),!0}).then(function(e){n.classList.remove("pending"),r.disabled=!1,r.value="",r.dispatchEvent(new CustomEvent("change"))}).then(function(e){return new Promise(function(e,t){return window.setTimeout(e,2e3)})}).then(function(e){o.className=""})})}(typer,advanced)}();

//# sourceMappingURL=support.min.js.map
